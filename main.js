(()=>{"use strict";class e{constructor(e,t,r){this._item=e,this._templateSelector=t,this.openHandler=r}_createClickHandler(){this.handle=this.openHandler.bind(this),this.card.querySelector(".photo-grid__item").addEventListener("click",(()=>this.openHandler(this._item)))}generateCard(){const e=document.querySelector(this._templateSelector).content.querySelector(".photo-grid__rectangle");this.card=e.cloneNode(!0);const t=this.card.querySelector(".photo-grid__item");return t.src=this._item.link,t.alt=this._item.name,this.card.querySelector(".photo-grid__name").textContent=this._item.name,this._createClickHandler(),this._createDeleteHandler(),this._createHeartHandler(),this.card}_createDeleteHandler(){this.card.querySelector(".trash").addEventListener("click",this._deleteHandler)}_deleteHandler(e){e.target.closest(".photo-grid__rectangle").remove()}_createHeartHandler(){this.card.querySelector(".photo-grid__heart").addEventListener("click",this._heartHandler)}_heartHandler(e){e.target.classList.toggle("photo-grid__heart_active")}}class t{constructor(e){this.popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this),this.setEventListeners()}open(){this.popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this.popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}_handleClose(e){this.close()}_handleCloseOverlay(e){e.target===this.popup&&this.close(),e.stopPropagation()}setEventListeners(){this.popup.querySelector(".popup__closed").addEventListener("click",this._handleClose.bind(this)),this.popup.addEventListener("click",this._handleCloseOverlay.bind(this))}}class r extends t{constructor(e,t){super(e),this.submitHandler=t,this.form=this.popup.querySelector("form"),this._inputList=this.popup.querySelectorAll("input")}open(){super.open()}close(){super.close(),this.form.reset()}_getInputValues(){return this._formValues={},this._inputList.forEach((e=>{this._formValues[e.name]=e.value})),this._formValues}_setInputValues(e){for(var t in e)this.popup.querySelector(`[name=${t}]`).value=e[t]}setEventListeners(){super.setEventListeners(),this.popup.querySelector("form").addEventListener("submit",(e=>{e.preventDefault(),this.submitHandler(this._getInputValues())}))}}class s{constructor(e,t){this.settings=e,this._formElement=t,this._inputList=Array.from(t.querySelectorAll(`.${this.settings.inputSelector}`)),this._buttonElement=t.querySelector(`.${this.settings.submitButtonSelector}`)}enableValidation=()=>{this._setEventListeners()};_setEventListeners=()=>{this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._isValid(e),this._enableDisableSaveButton()}))}))};validate(){this._inputList.forEach((e=>{this._hideInputError(e)})),this._enableDisableSaveButton()}_isValid(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_enableDisableSaveButton=()=>{this._inputList.some((e=>!e.validity.valid))?this._buttonElement.disabled=!0:this._buttonElement.disabled=!1};_showInputError=(e,t)=>{const r=e.nextElementSibling;e.classList.add(this.settings.inputErrorClass),r.textContent=t};_hideInputError=e=>{const t=e.nextElementSibling;e.classList.remove(this.settings.inputErrorClass),t.classList.remove(this.settings.errorClass),t.textContent=""}}document.querySelector(".profile__name"),document.querySelector(".profile__description"),document.querySelector(".popup__input_type_place-name"),document.querySelector(".popup__input_type_link");const n=document.querySelector("#profilePopup"),o=document.querySelector("#cardPopup"),i=document.querySelector("#imagePopup"),a=document.querySelector(".profile__edit-button"),p=document.querySelector(".profile__add-button"),l=(n.querySelector(".popup__closed"),o.querySelector(".popup__closed"),i.querySelector(".popup__closed"),document.querySelector("#card").content.querySelector(".photo-grid__rectangle"),document.querySelector(".photo-grid"),document.querySelector(".popup__image"),document.querySelector(".popup__image-name"),document.querySelector("#formProfile")),c=document.querySelector("#formCard"),d={formSelector:"popup__container",inputSelector:"popup__input",submitButtonSelector:"popup__submit",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"form__input-error_active"};new s(d,l).enableValidation();const u=new s(d,c);function h(t){return new e(t,"#card",y).generateCard()}u.enableValidation();const _=new class{constructor({items:e,renderer:t},r){this._renderedItems=e,this._renderer=t,this._container=document.querySelector(r)}addItem(e){this._container.append(e)}prependItem(e){this._container.prepend(e)}clear(){this._container.innerHTML=""}renderItems(){this.clear(),this._renderedItems.forEach((e=>{this._renderer(e)}))}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:e=>{const t=h(e);_.addItem(t)}},".photo-grid");_.renderItems();const m=new class{constructor(e,t){this.nameElement=document.querySelector(e),this.aboutElement=document.querySelector(t)}getUserInfo(){return{name:this.nameElement.textContent,description:this.aboutElement.textContent}}setUserInfo(e,t){this.nameElement.textContent=e,this.aboutElement.textContent=t}}(".profile__name",".profile__description");function y(e){g.open(e.link,e.name)}const g=new class extends t{constructor(e){super(e),this._popupImage=this.popup.querySelector(".popup__image"),this._imageName=this.popup.querySelector(".popup__image-name")}open(e,t){this._popupImage.src=e,this._popupImage.alt=t,this._imageName.textContent=t,super.open()}}("#imagePopup"),S=new r("#profilePopup",(e=>{m.setUserInfo(e.name,e.about),S.close()})),v=new r("#cardPopup",(e=>{const t=h({name:e.name,link:e.link});_.prependItem(t),v.close()}));a.addEventListener("click",(()=>{S.open();var e=m.getUserInfo();S._setInputValues({name:e.name,about:e.description})})),p.addEventListener("click",(()=>{v.open(),u.validate()}))})();